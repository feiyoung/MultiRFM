<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Low Dimensional Example of MultiRFM • MultiRFM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Low Dimensional Example of MultiRFM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiRFM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simu_high_dim.html">High Dimensional Example of MultiRFM</a>
    </li>
    <li>
      <a href="../articles/simu_low_dim.html">Low Dimensional Example of MultiRFM</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/feiyoung/MultiRFM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Low Dimensional Example of MultiRFM</h1>
                        <h4 data-toc-skip class="author">Wei Liu</h4>
            
            <h4 data-toc-skip class="date">2025-11-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/feiyoung/MultiRFM/blob/HEAD/vignettes/simu_low_dim.Rmd" class="external-link"><code>vignettes/simu_low_dim.Rmd</code></a></small>
      <div class="hidden name"><code>simu_low_dim.Rmd</code></div>

    </div>

    
    
<p>This vignette introduces the usage of MultiRFM for the analysis of
low-dimensional multi-study multivariate data with heavy tail, by
comparison with other methods.</p>
<p>The package can be loaded with the command, and define some metric
functions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/feiyoung/MultiRFM" class="external-link">MultiRFM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; MultiRFM :  We introduce a high-dimensional multi-study robust factor model, called MultiRFM, which learns latent features and accounts for the heterogeneity among source. It could be used for analyzing heterogeneous RNA sequencing data. More details can be referred to Jiang et al. (2025) &lt;doi:10.48550/arXiv.2506.18478&gt;.</span></span>
<span><span class="va">trace_statistic_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">H</span>, <span class="va">H0</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">tr_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">H0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr.solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H0</span></span>
<span></span>
<span>  <span class="fu">tr_fun</span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span> <span class="op">/</span> <span class="fu">tr_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">H0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H0</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="va">trace_list_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Hlist</span>, <span class="va">H0list</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">trvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Hlist</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">trvec</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">trvec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_statistic_fun</span><span class="op">(</span><span class="va">Hlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">H0list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trvec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="generate-the-simulated-data">Generate the simulated data<a class="anchor" aria-label="anchor" href="#generate-the-simulated-data"></a>
</h2>
<p>First, we generate the simulated data with heavy tail, where the
error term follows from a multivariate t-distribution with degree of
freedom 3.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># nu is set to</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>,<span class="fl">200</span><span class="op">)</span>;  <span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">3</span>;<span class="va">qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>; <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nvec</span><span class="op">)</span></span>
<span><span class="va">sigma2_eps</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">datList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gendata_simu_multi.html">gendata_simu_multi</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1</span>, nvec<span class="op">=</span><span class="va">nvec</span>, p<span class="op">=</span><span class="va">p</span>, q<span class="op">=</span><span class="va">q</span>, qs<span class="op">=</span><span class="va">qs</span>, rho<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, err.type<span class="op">=</span><span class="st">'mvt'</span>, sigma2_eps <span class="op">=</span> <span class="va">sigma2_eps</span>, nu<span class="op">=</span><span class="va">nu</span><span class="op">)</span></span></code></pre></div>
<p>Fit the MultiRFM model using the function <code><a href="../reference/MultiRFM.html">MultiRFM()</a></code> in
the R package <code>MultiRFM</code>. Users can use
<code><a href="../reference/MultiRFM.html">?MultiRFM</a></code> to see the details about this function. For two
matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>D</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\widehat D</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>,
we use trace statistic to measure their similarity. The trace statistic
ranges from 0 to 1, with higher values indicating better
performance.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">methodNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MultiRFM"</span>, <span class="st">"MSFA-CAVI"</span>, <span class="st">"MSFA-SVI"</span><span class="op">)</span></span>
<span><span class="va">metricMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">methodNames</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">metricMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A_tr'</span>, <span class="st">'B_tr'</span>,  <span class="st">'F_tr'</span>, <span class="st">'H_tr'</span>, <span class="st">'Time'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">metricMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">methodNames</span></span>
<span><span class="va">XList</span> <span class="op">&lt;-</span> <span class="va">datList</span><span class="op">$</span><span class="va">Xlist</span>;</span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiRFM.html">MultiRFM</a></span><span class="op">(</span><span class="va">XList</span>, q<span class="op">=</span><span class="va">q</span>, qs<span class="op">=</span><span class="va">qs</span><span class="op">)</span></span>
<span><span class="co">#&gt; iter = 2, ELBO= -58129.560859, dELBO=0.999973 </span></span>
<span><span class="co">#&gt; iter = 3, ELBO= -49414.109943, dELBO=0.149931 </span></span>
<span><span class="co">#&gt; iter = 4, ELBO= -44128.600439, dELBO=0.106964 </span></span>
<span><span class="co">#&gt; iter = 5, ELBO= -42446.048326, dELBO=0.038128 </span></span>
<span><span class="co">#&gt; iter = 6, ELBO= -42135.587653, dELBO=0.007314 </span></span>
<span><span class="co">#&gt; iter = 7, ELBO= -42010.848147, dELBO=0.002960 </span></span>
<span><span class="co">#&gt; iter = 8, ELBO= -41925.829940, dELBO=0.002024 </span></span>
<span><span class="co">#&gt; iter = 9, ELBO= -41860.757536, dELBO=0.001552 </span></span>
<span><span class="co">#&gt; iter = 10, ELBO= -41808.729928, dELBO=0.001243 </span></span>
<span><span class="co">#&gt; iter = 11, ELBO= -41766.027404, dELBO=0.001021 </span></span>
<span><span class="co">#&gt; iter = 12, ELBO= -41730.319533, dELBO=0.000855 </span></span>
<span><span class="co">#&gt; iter = 13, ELBO= -41700.030305, dELBO=0.000726 </span></span>
<span><span class="co">#&gt; iter = 14, ELBO= -41674.040116, dELBO=0.000623 </span></span>
<span><span class="co">#&gt; iter = 15, ELBO= -41651.524890, dELBO=0.000540 </span></span>
<span><span class="co">#&gt; iter = 16, ELBO= -41631.861358, dELBO=0.000472 </span></span>
<span><span class="co">#&gt; iter = 17, ELBO= -41614.567784, dELBO=0.000415 </span></span>
<span><span class="co">#&gt; iter = 18, ELBO= -41599.265115, dELBO=0.000368 </span></span>
<span><span class="co">#&gt; iter = 19, ELBO= -41585.650580, dELBO=0.000327 </span></span>
<span><span class="co">#&gt; iter = 20, ELBO= -41573.479195, dELBO=0.000293 </span></span>
<span><span class="co">#&gt; iter = 21, ELBO= -41562.550504, dELBO=0.000263 </span></span>
<span><span class="co">#&gt; iter = 22, ELBO= -41552.698856, dELBO=0.000237 </span></span>
<span><span class="co">#&gt; iter = 23, ELBO= -41543.786157, dELBO=0.000214 </span></span>
<span><span class="co">#&gt; iter = 24, ELBO= -41535.696373, dELBO=0.000195 </span></span>
<span><span class="co">#&gt; iter = 25, ELBO= -41528.331313, dELBO=0.000177 </span></span>
<span><span class="co">#&gt; iter = 26, ELBO= -41521.607345, dELBO=0.000162 </span></span>
<span><span class="co">#&gt; iter = 27, ELBO= -41515.452815, dELBO=0.000148 </span></span>
<span><span class="co">#&gt; iter = 28, ELBO= -41509.805996, dELBO=0.000136 </span></span>
<span><span class="co">#&gt; iter = 29, ELBO= -41504.613448, dELBO=0.000125 </span></span>
<span><span class="co">#&gt; iter = 30, ELBO= -41499.828687, dELBO=0.000115</span></span>
<span><span class="co">#str(res)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MultiRFM"</span>,<span class="st">'Time'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">time_use</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MultiRFM"</span>,<span class="st">'A_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_statistic_fun</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">A</span>, <span class="va">datList</span><span class="op">$</span><span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MultiRFM"</span>,<span class="st">'B_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">B</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Blist0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MultiRFM"</span>,<span class="st">'F_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="cn">F</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Flist</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MultiRFM"</span>,<span class="st">'H_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">H</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Hlist</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-with-other-methods">Compare with other methods<a class="anchor" aria-label="anchor" href="#compare-with-other-methods"></a>
</h2>
<p>We compare MultiRFM with two prominent methods: MSFA-CAVI and
MSFA-SVI</p>
<p>First, we implement MSFA-CAVI:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">XList</span>, <span class="va">scale</span>, scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">hmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">XList</span>, <span class="va">colMeans</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">VIMSFA</span><span class="op">)</span></span>
<span><span class="co">### MSFA-CAVI</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"MSFA-CAVI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MSFA-CAVI"</span></span>
<span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cavi_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VIMSFA/man/cavi_msfa.html" class="external-link">cavi_msfa</a></span><span class="op">(</span><span class="va">X_s</span>,  K<span class="op">=</span><span class="va">q</span>, J_s<span class="op">=</span><span class="va">qs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 3.98240e+03, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 9.18458e+02, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 1.62926e+03, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "Algorithm converged in 5 iterations."</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_cavi</span> <span class="op">&lt;-</span> <span class="va">toc</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">tic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">hLam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">cavi_est</span><span class="op">$</span><span class="va">mean_psi_s</span><span class="op">)</span></span>
<span><span class="va">hF_cavi</span> <span class="op">&lt;-</span> <span class="va">hH_cavi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">S</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># s &lt;- 1</span></span>
<span>  <span class="va">hF_cavi</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">cavi_est</span><span class="op">$</span><span class="va">mean_f</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">hH_cavi</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">cavi_est</span><span class="op">$</span><span class="va">mean_l</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-CAVI"</span>,<span class="st">'Time'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">time_cavi</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-CAVI"</span>,<span class="st">'A_tr'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">trace_statistic_fun</span><span class="op">(</span><span class="va">cavi_est</span><span class="op">$</span><span class="va">mean_phi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-CAVI"</span>,<span class="st">'B_tr'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">cavi_est</span><span class="op">$</span><span class="va">mean_lambda_s</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Blist0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-CAVI"</span>,<span class="st">'F_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">hF_cavi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Flist</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-CAVI"</span>,<span class="st">'H_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">hH_cavi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Hlist</span><span class="op">)</span></span></code></pre></div>
<p>Next, we implement MSFA-SVI:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"MSFA-SVI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MSFA-SVI"</span></span>
<span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">svi_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VIMSFA/man/svi_msfa.html" class="external-link">svi_msfa</a></span><span class="op">(</span><span class="va">X_s</span>, K<span class="op">=</span><span class="va">q</span>, J_s<span class="op">=</span><span class="va">qs</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 3.96309e+03, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 9.16857e+02, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "Iteration:    1, Objective: 1.64725e+03, Relative improvement Inf"</span></span>
<span><span class="co">#&gt; [1] "iteration 1 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 2 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 3 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 4 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 5 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 6 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 7 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 8 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 9 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 10 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 11 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 12 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 13 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 14 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 15 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 16 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 17 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 18 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 19 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 20 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 21 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 22 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 23 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 24 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 25 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 26 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 27 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 28 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 29 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 30 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 31 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 32 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 33 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 34 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 35 finished"</span></span>
<span><span class="co">#&gt; [1] "iteration 36 finished"</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_svi</span> <span class="op">&lt;-</span> <span class="va">toc</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">tic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">hLam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">svi_est</span><span class="op">$</span><span class="va">mean_psi_s</span><span class="op">)</span></span>
<span><span class="va">hF_cavi</span> <span class="op">&lt;-</span> <span class="va">hH_cavi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">S</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># s &lt;- 1</span></span>
<span>  <span class="va">hF_cavi</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">svi_est</span><span class="op">$</span><span class="va">mean_f</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">hH_cavi</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">svi_est</span><span class="op">$</span><span class="va">mean_l</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-SVI"</span>,<span class="st">'Time'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">time_cavi</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-SVI"</span>,<span class="st">'A_tr'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">trace_statistic_fun</span><span class="op">(</span><span class="va">svi_est</span><span class="op">$</span><span class="va">mean_phi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-SVI"</span>,<span class="st">'B_tr'</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">svi_est</span><span class="op">$</span><span class="va">mean_lambda_s</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Blist0</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-SVI"</span>,<span class="st">'F_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">hF_cavi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Flist</span><span class="op">)</span></span>
<span><span class="va">metricMat</span><span class="op">[</span><span class="st">"MSFA-SVI"</span>,<span class="st">'H_tr'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">trace_list_fun</span><span class="op">(</span><span class="va">hH_cavi</span>, <span class="va">datList</span><span class="op">$</span><span class="va">Hlist</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-comparison-of-performance">Visualize the comparison of performance<a class="anchor" aria-label="anchor" href="#visualize-the-comparison-of-performance"></a>
</h2>
<p>Next, we summarized the metrics for MultiRFM and other compared
methods in a data.frame object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">dat_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">metricMat</span><span class="op">)</span></span>
<span><span class="va">dat_metric</span><span class="op">$</span><span class="va">Method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dat_metric</span><span class="op">)</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dat_metric</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot the results for MultiRFM and other methods, which suggests that
MultiRFM achieves better estimation accuracy for the study-shared
loading matrix A, study-specified loading matrix B and factor matrix H.
MultiRFM significantly outperforms the compared methods in terms of
estimation accuracy of B and H, as well as computational efficiency.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.4.3</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">A_tr</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">A_tr</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">F_tr</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">F_tr</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">B_tr</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">B_tr</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">H_tr</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">H_tr</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_metric</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Method</span>, y<span class="op">=</span><span class="va">Time</span>, fill<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span>, <span class="va">p4</span>,  <span class="va">p5</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="simu_low_dim_files/figure-html/unnamed-chunk-8-1.png" width="1248"></p>
</div>
<div class="section level2">
<h2 id="select-the-parameters">Select the parameters<a class="anchor" aria-label="anchor" href="#select-the-parameters"></a>
</h2>
<p>We applied the proposed ‘CUP’ method to select the number of factors.
The results showed that the CUP method has the potential to identify the
true values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">datList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gendata_simu_multi.html">gendata_simu_multi</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1</span>, nvec<span class="op">=</span><span class="va">nvec</span>, p<span class="op">=</span><span class="va">p</span>, q<span class="op">=</span><span class="va">q</span>, qs<span class="op">=</span><span class="va">qs</span>, rho<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, err.type<span class="op">=</span><span class="st">'mvt'</span>, sigma2_eps <span class="op">=</span></span>
<span>                                <span class="va">sigma2_eps</span>, nu<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">XList</span> <span class="op">&lt;-</span> <span class="va">datList</span><span class="op">$</span><span class="va">Xlist</span>;</span>
<span><span class="va">q_max</span> <span class="op">&lt;-</span> <span class="fl">6</span>; <span class="va">qs_max</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">hq.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectFac.MultiRFM.html">selectFac.MultiRFM</a></span><span class="op">(</span><span class="va">XList</span>,  q_max<span class="op">=</span><span class="va">q_max</span>, qs_max<span class="op">=</span><span class="va">qs_max</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"hq = "</span>, <span class="va">hq.list</span><span class="op">$</span><span class="va">q</span>, <span class="st">" VS true q = "</span>, <span class="va">q</span><span class="op">)</span></span>
<span><span class="co">#&gt; hq = 3 VS true q = 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"hqs.vec = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">hq.list</span><span class="op">$</span><span class="va">qs</span>, collapse <span class="op">=</span><span class="st">", "</span><span class="op">)</span>, <span class="st">" VS true qs.vec = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">qs</span>, collapse <span class="op">=</span><span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; hqs.vec = 2, 2 VS true qs.vec = 2, 2</span></span></code></pre></div>
<details><summary><strong>Session Info</strong>
</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 26100)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=Chinese (Simplified)_China.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=Chinese (Simplified)_China.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=Chinese (Simplified)_China.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                               </span></span>
<span><span class="co">#&gt; [5] LC_TIME=Chinese (Simplified)_China.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Asia/Shanghai</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.5.2  cowplot_1.1.3  VIMSFA_0.1.0   MultiRFM_1.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.5         xfun_0.47            bslib_0.8.0         </span></span>
<span><span class="co">#&gt;  [4] htmlwidgets_1.6.4    lattice_0.22-6       vctrs_0.6.5         </span></span>
<span><span class="co">#&gt;  [7] tools_4.4.1          generics_0.1.3       parallel_4.4.1      </span></span>
<span><span class="co">#&gt; [10] tibble_3.2.1         fansi_1.0.6          highr_0.11          </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3      Matrix_1.7-0         data.table_1.16.0   </span></span>
<span><span class="co">#&gt; [16] desc_1.4.3           lifecycle_1.0.4      compiler_4.4.1      </span></span>
<span><span class="co">#&gt; [19] farver_2.1.2         mixtools_2.0.0       textshaping_0.4.0   </span></span>
<span><span class="co">#&gt; [22] munsell_0.5.1        mnormt_2.1.1         htmltools_0.5.8.1   </span></span>
<span><span class="co">#&gt; [25] sass_0.4.9           yaml_2.3.10          lazyeval_0.2.2      </span></span>
<span><span class="co">#&gt; [28] plotly_4.10.4        pillar_1.9.0         pkgdown_2.1.1       </span></span>
<span><span class="co">#&gt; [31] jquerylib_0.1.4      tidyr_1.3.1          MASS_7.3-60.2       </span></span>
<span><span class="co">#&gt; [34] cachem_1.1.0         nlme_3.1-164         sparsepca_0.1.2     </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1     rsvd_1.0.5           digest_0.6.37       </span></span>
<span><span class="co">#&gt; [40] mvtnorm_1.3-1        dplyr_1.1.4          LaplacesDemon_16.1.6</span></span>
<span><span class="co">#&gt; [43] purrr_1.0.2          kernlab_0.9-33       labeling_0.4.3      </span></span>
<span><span class="co">#&gt; [46] splines_4.4.1        fastmap_1.2.0        grid_4.4.1          </span></span>
<span><span class="co">#&gt; [49] colorspace_2.1-1     cli_3.6.3            magrittr_2.0.3      </span></span>
<span><span class="co">#&gt; [52] survival_3.6-4       utf8_1.2.4           withr_3.0.1         </span></span>
<span><span class="co">#&gt; [55] scales_1.3.0         segmented_2.1-2      rmarkdown_2.28      </span></span>
<span><span class="co">#&gt; [58] httr_1.4.7           ragg_1.3.3           evaluate_1.0.0      </span></span>
<span><span class="co">#&gt; [61] knitr_1.48           irlba_2.3.5.1        viridisLite_0.4.2   </span></span>
<span><span class="co">#&gt; [64] rlang_1.1.4          Rcpp_1.0.13          glue_1.7.0          </span></span>
<span><span class="co">#&gt; [67] rstudioapi_0.16.0    jsonlite_1.8.9       R6_2.5.1            </span></span>
<span><span class="co">#&gt; [70] systemfonts_1.1.0    fs_1.6.4</span></span></code></pre></div>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Wei Liu, Xiaolu Jiang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
